---
title: "SI 618 Lab 10"
output: html_document
---

In this lab, you'll practice using k-means clustering on a Pokemon dataset.  The file **Pokemon.csv** is provided in the zip file. Unlike other assignments, you don't need to use ggplot() here to create these plots: just plot() will do. We have also provided an example document (si618_lab10_solution.html) of the intended solution.

## Part 1. Data preparation (20 points)

To prepare for clustering, you need to extract the relevant columns: HP, Attack, Defense, Sp..Atk, Sp..Def, and Speed. Next, scale the data: Do this by calling the appropriate R scaling function: use settings so that each variable (column) is centered by subtracting the variable (column) mean, and scaled by dividing by the variable's standard deviation. 

Show the first 5 rows of the scaled data frame: 

```{r, echo=FALSE, fig.width=14, message=FALSE, warning=FALSE}
library(data.table)
data <- fread("Pokemon.csv",sep = ",", header = TRUE, quote="",fill=TRUE, colClasses=c(rep("NULL",5),rep("integer",6),rep("NULL",2)))
data <- scale(data)
head(data,5)
```


## Part 2. Identify the correct number of clusters (40 points)

The first challenge with the Pokemon data is that there is no pre-determined number of clusters. You will assess the appropriate number of clusters by inspecting how the within group sum of squares varies with respect to the number of clusters. Keep in mind that in real data the elbow in the scree plot might be less of a sharp elbow than in synthetic data. Use the simple plot() function to visualize the within group sum of squares for when k=1:15. 

```{r, echo=FALSE, fig.width=8, fig.height=8}
wss <- (nrow(data)-1)*sum(apply(data,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(data, centers=i)$withinss)
plot(1:15, wss, type="b", xlab="Number of Clusters",
  ylab="Within groups sum of squares")
```

## Part 3. Plot the clusters (40 points) 
#### a) Plot the outcomes of the clustering on two dimensions of the data when k (number of clusters) = 3. 
Here, you should plot what cluster the data points with given Defense and Speed characteristics are assigned to (x-axis: Defense, y-axis: Speed, color:cluster assigned). You should use the plot() function. Your plot should look something like this:

```{r, echo=FALSE, fig.width=12, fig.height=12}
fit <- kmeans(data, 3)
#aggregate(data,by=list(fit$cluster),FUN=mean)
data_3c <- data.frame(data, fit$cluster)
plot(data_3c$Defense,data_3c$Speed, type="p", col=data_3c$fit.cluster,main="k-means clustering of Pokemon with 3 clusters",xlab="Defense",ylab="Speed")
```

Next plot the relationship between Attack, Defense and the clusters assigned in a similar fashion. Your plot should look like this:

```{r, echo=FALSE, fig.width=12, fig.height=12}
plot(data_3c$Defense,data_3c$Attack, type="p", col=data_3c$fit.cluster,main="k-means clustering of Pokemon with 3 clusters",xlab="Defense",ylab="Attack")
```

#### b) Repeat the same analysis for k=2.

```{r, echo=FALSE, fig.width=12, fig.height=12}
fit <- kmeans(data, 2)
#aggregate(data,by=list(fit$cluster),FUN=mean)
data_2c <- data.frame(data, fit$cluster)
plot(data_2c$Defense,data_2c$Speed, type="p", col=data_2c$fit.cluster,main="k-means clustering of Pokemon with 2 clusters",xlab="Defense",ylab="Speed")
plot(data_2c$Defense,data_2c$Attack, type="p", col=data_2c$fit.cluster,main="k-means clustering of Pokemon with 2 clusters",xlab="Defense",ylab="Attack")
```

## What to submit?
A zip file named 'si618_lab10_youruniquename.zip' containing:

* The R Markdown file you wrote, named 'si618_lab10_youruniquename.Rmd'
* The HTML report generated by your R Markdown file. 